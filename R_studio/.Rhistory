setwd(.~/U-M/BioInf)
setwd(~/U-M/BioInf)
setwd("~/U-M/BioInf")
?write.table
?split
?dplyr
??dplyr
install.packages("ggplot2")
ggplot(recomb_compar) + geom_bar(aes(x=motif, y=mean_recomb)) #graph
library(ggplot2)
ggplot(recomb_compar) + geom_bar(aes(x=motif, y=mean_recomb)) #graph
rec <- read.csv("motif_recombrates.txt", sep = '', header = TRUE)
rec <- read.csv("motif_recombrates.txt", sep = '', header = TRUE)
rec <- read.csv("motif_recombrates.txt", sep = '', header = TRUE)
rec <- read.csv("motif_recombrates.txt", sep = '', header = TRUE)
rep <- read.csv("motif_repeats.txt", sep = '', header = TRUE) #reading the data
rec$pos <- paste(rec$chr, rec$motif_start, sep = "-")
rep$pos <- paste(rep$chr, rep$motif_start, sep = "-") #making the columns of specific positions per chromosome
recomb <- merge(rec, rep, by.x = "pos", by.y = "pos") #merging
aggregate(recomb$recom, list(name=recomb$name), mean) #finding the mean
library(ggplot2) #loading ggplot
ggplot(recomb) + geom_density(aes(x=recom, fill=name)) #graphing and making the type of motives of different color
table(recomb$name) #this was just to check how many different types of motif were
table(recomb$name) #this was just to check how many different types of motif were
recomb_compar <- aggregate(recomb$recom, list(motif=recomb$name), mean) #created a dataset for the graph with the means for recombination rate of each type of motif
recomb_compar$motif <- factor(recomb_compar$motif, levels=c("L2", "THE1B", "Total")) #created a new Total level for my new dataset
recomb_compar[3,] <- c("Total", mean(recomb$recom)) #added the data for total recom rate mean
colnames(recomb_compar)[2] <- "mean_recomb" #renamed the mean column
ggplot(recomb_compar) + geom_bar(aes(x=motif, y=mean_recomb)) #graph
recomb_compar
ggplot(recomb_compar) + geom_bar(aes(x=motif, y=mean_recomb)) #graph
rec
head(rec, n=3)
head(recomb, n=3)
recomb_compar
transcript <- read.csv("Homo_sapiens.GRCh38.82.abinitio_transcript.bed", header = FALSE, sep = "")
setwd("~/U-M/BioInf/MidTerm")
transcript <- read.csv("Homo_sapiens.GRCh38.82.abinitio_transcript.bed", header = FALSE, sep = "")
exon <- read.csv("Homo_sapiens.GRCh38.82.abinitio_exon.bed", header = FALSE, sep = "") #reading the two datasets, and setting no header, and field separation.
colnames(transcript)[1] <- "chr"
colnames(transcript)[3] <- "seq_type"
colnames(transcript)[4] <- "start"
colnames(transcript)[5] <- "end"
colnames(exon)[c(1, 3, 4, 5)] <- colnames(transcript)[c(1, 3, 4 ,5)] #changing the column names for relevant columns to ease workflow.
transcript$length <- paste(transcript$end - transcript$start)
exon$length <- paste(exon$end - exon$start) #creating a field for sequence length.
apply(transcript$chr, 2, unique)
transcript_split <- split(transcript$length, transcript$chr)
mean(transcript_split)
transcript_split
str(transcript_split)
typeof(transcript$length)
typeof(transcript$length) <- "numeric"
transcript$length <- transcript$end - transcript$start
exon$length <- exon$end - exon$start #creating a field for sequence length.
transcript_split <- split(transcript$length, transcript$chr)
exon_split <- split(exon$length, exon$chr)
exon$length <- exon$end - exon$start  #creating a field for sequence length.
str(transcript_split)
lapply(transcript_split, mean)
sapply(transcript_split, mean)
transcript_length_mean <- sapply(transcript_split, mean)
transcript_length_mean
do.call(rbind, lapply(split(transcript$length, transcript$chr), mean))
transcript_length_mean <- do.call(rbind, lapply(split(transcript$length, transcript$chr), mean))
exon_length_mean <- do.call(rbind, lapply(split(exon$length, exon$chr), mean))
aggregate(transcript$length, list(chr=transcript$chr), mean)
transcript_length_mean <- aggregate(transcript$length, list(chr=transcript$chr), mean)
exon_length_mean <- aggregate(exon$length, list(chr=exon$chr), mean)
aggregate(exon$length, exon$chr("X"))
(exon$length, exon$chr("X")
exon$length, exon$chr("X")
exon$length exon$chr("X")
subset(transcript$length, transcript$chr="X")
subset(transcript$chr = X, transcript$length)
subset(transcript, transcript$chr = X, c(chr, length))
subset(transcript, transcript$chr = "X", c(chr, length))
subset(transcript, chr = "X", c(chr, length))
subset(transcript, chr = X, c(chr, length))
subset(transcript, chr = "x", c(chr, length))
subset(transcript, chr == "x", c(chr, length))
subset(transcript, chr == "X", c(chr, length))
his(subset(transcript, chr == "X", c(chr, length)) + right=FALSE)
transcript_X_length <- subset(transcript, chr == )
transcript_X_length <- subset(transcript, chr == "X", c(chr, length))
exon_X_length <- subset(exon, chr == "X", c(chr, length))
exon_Y_length <- subset(exon, chr == "Y", c(chr, length))
hist(exon_X_length, + right = FALSE)
hist(exon_X_length, + right=FALSE)
hist(exon_X_length)
hist(subset(exon, chr == "X", c(length)), right = FALSE)
exon_X_length <- subset(exon, chr == "X", c(length))
head(exon_X_length)
head(subset(exon, chr == "X", c(length)))
head(subset(exon, chr == "X")
)
exon_Y_length <- subset(exon, chr == "Y", c(length))
head(exon_X_length$length)
hist(exon_X_length$length, right = FALSE)
hist(exon_X_length$length, right = FALSE, xlim = 2000)
hist(exon_X_length$length, right = FALSE, xlim = "2000")
hist(exon_X_length$length, right = FALSE)
hist(exon_X_length$length, right = FALSE, main="Chromosome X", xlab="Exon length")
hist(exon_X_length$length, right = FALSE, main="Chromosome X", xlab="Exon length", xlim = 1000)
hist(exon_X_length$length, right = FALSE, main="Chromosome X", xlab="Exon length")
hist(exon_Y_length$length, right = FALSE, main="Chromosome Y", xlab="Exon length")
View(exon_X_length)
hist(exon_X_length$length, right = FALSE, main="Chromosome X", xlab="Exon length", breaks = 1000)
hist(exon_X_length$length, right = FALSE, main="Chromosome X", xlab="Exon length", breaks = 100)
hist(exon_X_length$length, right = FALSE, main="Chromosome X", xlab="Exon length", breaks = 100, xlim = range(100))
hist(exon_X_length$length, right = FALSE, main="Chromosome X", xlab="Exon length", breaks = 100, xlim = range(1000))
hist(exon_X_length$length, right = FALSE, main="Chromosome X", xlab="Exon length", breaks = 1000, xlim = range(1000))
hist(exon_X_length$length, right = FALSE, main="Chromosome X", xlab="Exon length", breaks = 1000, xlim = range(600))
hist(exon_X_length$length, right = FALSE, main="Chromosome X", xlab="Exon length", breaks = 1000, xlim = range(0))
hist(exon_X_length$length, right = FALSE, main="Chromosome X", xlab="Exon length", breaks = 1000, xlim = range(500))
hist(exon_X_length$length, right = FALSE, main="Chromosome X", xlab="Exon length", breaks = 1000, xlim = range(200))
hist(exon_X_length$length, right = FALSE, main="Chromosome X", xlab="Exon length", breaks = 1000, xlim = range(100))
hist(exon_X_length$length, right = FALSE, main="Chromosome X", xlab="Exon length", breaks = 1000, xlim = range(150))
hist(exon_X_length$length, right = FALSE, main="Chromosome X", xlab="Exon length", xlim = range(150))
hist(exon_X_length$length, right = FALSE, main="Chromosome X", xlab="Exon length", xlim = range(2000))
hist(exon_X_length$length, right = FALSE, main="Chromosome X", xlab="Exon length", break = 100
hist(exon_X_length$length, right = FALSE, main="Chromosome X", xlab="Exon length", break = 100)
hist(exon_X_length$length, right = FALSE, main="Chromosome X", xlab="Exon length", breaks = 100)
hist(exon_X_length$length, right = FALSE, main="Chromosome X", xlab="Exon length", breaks = nrow(exon_X_length$length))
nrow(exon_X_length$length)
ncol(exon_X_length$length)
count.fields(exon_X_length)
count.fields(exon_X_length$length)
head(exon_X_length)
nrow(exon_X_length)
hist(exon_X_length$length, right = FALSE, main="Chromosome X", xlab="Exon length", breaks = nrow(exon_X_length))
hist(exon_X_length$length, right = FALSE, main="Chromosome X", xlab="Exon length", breaks = nrow(exon_X_length), xlim = range(nrow(exon_X_length)))
hist(exon_X_length$length, right = FALSE, main="Chromosome X", xlab="Exon length", breaks = nrow(exon_X_length), xlim = range(100)
)
hist(exon_X_length$length, right = FALSE, main="Chromosome X", xlab="Exon length", breaks = nrow(exon_X_length), xlim = range(100))
hist(exon_X_length$length, right = FALSE, main="Chromosome X", xlab="Exon length", breaks = nrow(exon_X_length), xlim = range(0))
hist(exon_X_length$length, right = FALSE, main="Chromosome X", xlab="Exon length", breaks = nrow(exon_X_length), xlim = range(1))
hist(exon_X_length$length, right = FALSE, main="Chromosome X", xlab="Exon length", breaks = nrow(exon_X_length), xlim = range(10000))
hist(exon_X_length$length, right = TURE, main="Chromosome X", xlab="Exon length", breaks = nrow(exon_X_length), xlim = range(1000))
hist(exon_X_length$length, right = TrUE, main="Chromosome X", xlab="Exon length", breaks = nrow(exon_X_length), xlim = range(1000))
hist(exon_X_length$length, right = TRUE, main="Chromosome X", xlab="Exon length", breaks = nrow(exon_X_length), xlim = range(1000))
hist(exon_X_length$length, right = TRUE, main="Chromosome X", xlab="Exon length", breaks = nrow(exon_X_length))
hist(exon_X_length$length, right = TRUE, main="Chromosome X", xlab="Exon length", breaks = nrow(exon_X_length), xlim = 500)
hist(exon_X_length$length, right = TRUE, main="Chromosome X", xlab="Exon length", breaks = nrow(exon_X_length), xlim = range(500))
hist(exon_X_length$length, right = TRUE, main="Chromosome X", xlab="Exon length", breaks = nrow(exon_X_length), xlim = range(0-500))
hist(exon_X_length$length, right = TRUE, main="Chromosome X", xlab="Exon length", breaks = nrow(exon_X_length))
hist(exon_Y_length$length, right = TRUE, main="Chromosome Y", xlab="Exon length", breaks = nrow(exon_Y_length))
View(transcript_length_mean)
transcript_length_mean <- aggregate(transcript$length, list(chr=transcript$chr), mean)
head(aggregate(transcript$length, list(chr=transcript$chr), mean, stderr)
)
head(aggregate(transcript$length, list(chr=transcript$chr), mean))
head(aggregate(transcript$length, list(chr=transcript$chr), summary))
head(aggregate(transcript$length, list(chr=transcript$chr), stderr))
head(aggregate(transcript$length, list(chr=transcript$chr), mean, var))
head(aggregate(transcript$length, list(chr=transcript$chr), var))
tail(aggregate(transcript$length, list(chr=transcript$chr), var))
head(aggregate(transcript$length, list(chr=transcript$chr), mean, var))
head(aggregate(transcript$length, list(chr=transcript$chr), mean))
View(exon_length_mean)
head(aggregate(exon$length, list(chr=exon$chr), sum))
head(aggregate(transcript$length, list(chr=transcript$chr), sum))
total_chr_length <- aggregate(transcript$length, list(chr=transcript$chr), sum))
total_chr_length <- aggregate(transcript$length, list(chr=transcript$chr), sum)
View(total_chr_length)
colnames(exon_length_mean[2])
colnames(exon_length_mean[2]) <- "mean"
colnames(exon_length_mean[2])
colnames(exon_length_mean[2])
colnames(exon_length_mean[2]) <- "mean"
colnames(exon_length_mean[2])
colnames(exon_length_mean)[2]
colnames(exon_length_mean)[2] <- "mean"
colnames(exon_length_mean)[2]
View(exon_length_mean)
colnames(total_chr_length)[2]
colnames(total_chr_length)[2] <- "sum"
colnames(total_chr_length)[2]
View(total_chr_length)
head(merge(total_chr_length, exon_length_mean, by.x = "chr", by.y = "chr"))
exon_chr_merge <- merge(total_chr_length, exon_length_mean, by.x = "chr", by.y = "chr")
library(ggplot2)
View(exon_chr_merge)
ggplot(exon_chr_merge, aes(x=sum, y=mean)) + geom_point() + geom_smooth()
ggplot(exon_chr_merge, aes(x=sum, y=mean)) + geom_point()
ggplot(exon_chr_merge, aes(x=sum, y=mean)) + geom_bar()
ggplot(exon_chr_merge, aes(x=sum, y=mean)) + geom_point() + geom_smooth()
ggplot(exon_chr_merge, aes(x=sum, y=mean)) + geom_point() + geom_smooth(method=x)
ggplot(exon_chr_merge, aes(x=sum, y=mean)) + geom_point() + geom_smooth(method=sum)
ggplot(exon_chr_merge, aes(x=sum, y=mean)) + geom_point() + geom_smooth(method = sum)
ggplot(exon_chr_merge, aes(x=sum, y=mean)) + geom_point() + geom_smooth(method = "sum")
ggplot(exon_chr_merge, aes(x=sum, y=mean)) + geom_point() + geom_smooth(method = mean)
ggplot(exon_chr_merge, aes(x=sum, y=mean)) + geom_point() + geom_smooth(method=sum)
ggplot(exon_chr_merge, aes(x=sum, y=mean)) + geom_point() + geom_smooth()
ggplot(exon_chr_merge, aes(x=sum, y=mean)) + geom_point() + geom_smooth(aes(x=sum))
ggplot(exon_chr_merge, aes(x=sum, y=mean)) + geom_point() + geom_smooth(, method=sum)
ggplot(exon_chr_merge, aes(x=sum, y=mean)) + geom_point() + geom_smooth(aes(x=sum), method=sum)
ggplot(exon_chr_merge, aes(x=sum, y=mean)) + geom_point() + geom_smooth(aes(x=sum, weight = "auto"), method=sum)
ggplot(exon_chr_merge, aes(x=sum, y=mean)) + geom_point() + geom_smooth(weight = "auto")
ggplot(exon_chr_merge, aes(x=sum, y=mean)) + geom_point() + geom_smooth(weight = sum)
ggplot(exon_chr_merge, aes(y=sum, x=mean)) + geom_point() + geom_smooth()
ggplot(exon_chr_merge) + geom_bar(aes(x=sum, y=mean))
plot(exon_chr_merge$chr, exon_chr_merge$sum)
ggplot(exon_chr_merge) + geom_boxplot(aes(x=sum))
ggplot(exon_chr_merge) + geom_boxplot(aes(x=sum, y = chr))
ggplot(exon_chr_merge) + geom_bar(aes(x=chr, y=sum)) + geom_line(aes(x=chr, y=mean))
ggplot(exon_chr_merge) + geom_bar(aes(x=chr, y=sum), stat="identity") + geom_line(aes(x=chr, y=mean))
plot(exon_chr_merge$mean, exon_chr_merge$sum)
plot(exon_chr_merge$mean, exon_chr_merge$sum) + abline(lm(sum ~ mean, data = exon_chr_merge))
plot(exon_chr_merge$mean, exon_chr_merge$sum)
plot(exon_chr_merge$mean, exon_chr_merge$sum, xlim = c(0, 1000))
plot(exon_chr_merge$sum, exon_chr_merge$mean)
plot(exon_chr_merge$sum, exon_chr_merge$mean, xlim = c(0, 50000000), ylim = c(0, 1000))
plot(exon_chr_merge$sum, exon_chr_merge$mean, xlim = c(0, 10000000), ylim = c(0, 1000))
plot(exon_chr_merge$sum, exon_chr_merge$mean, xlim = c(0, 4000000), ylim = c(0, 1000))
plot(exon_chr_merge$sum, exon_chr_merge$mean, xlim = c(0, 1000000), ylim = c(0, 1000))
plot(exon_chr_merge$sum, exon_chr_merge$mean, pch=19, xlim = c(0, 500000), ylim = c(0, 1000))
plot(exon_chr_merge$sum, exon_chr_merge$mean, pch=19, xlim = c(0, 450000), ylim = c(0, 1000))
plot(exon_chr_merge$sum, exon_chr_merge$mean, pch=19, xlim = c(0, 400000), ylim = c(0, 1000))
plot(exon_chr_merge$sum, exon_chr_merge$mean, pch=19, xlim = c(0, 400000), ylim = c(0, 1000)) + abline(lm(mean ~ sum, data=exon_chr_merge))
plot(exon_chr_merge$sum, exon_chr_merge$mean, pch=19, xlim = c(0, 1000000), ylim = c(0, 1000)) + abline(lm(mean ~ sum, data=exon_chr_merge))
plot(exon_chr_merge$sum, exon_chr_merge$mean, pch=19) + abline(lm(mean ~ sum, data=exon_chr_merge))
plot(exon_chr_merge$sum, exon_chr_merge$mean, pch=19, color = "blue", xlab = "Total chr length", ylab = "Mean exon length") + abline(lm(mean ~ sum, data=exon_chr_merge))
plot(exon_chr_merge$sum, exon_chr_merge$mean, pch=19, col = "blue", xlab = "Total chr length", ylab = "Mean exon length") + abline(lm(mean ~ sum, data=exon_chr_merge))
plot(exon_chr_merge$sum, exon_chr_merge$mean, pch=19, xlab = "Total chr length", ylab = "Mean exon length") + abline(lm(mean ~ sum, data=exon_chr_merge))
plot(exon_chr_merge$sum, exon_chr_merge$mean, pch=19, xlab = "Total chr length", ylab = "Mean exon length", cex = 2) + abline(lm(mean ~ sum, data=exon_chr_merge))
plot(exon_chr_merge$sum, exon_chr_merge$mean, pch=19, xlab = "Total chr length", ylab = "Mean exon length", cex = 0.5) + abline(lm(mean ~ sum, data=exon_chr_merge))
plot(exon_chr_merge$sum, exon_chr_merge$mean, pch=19, xlab = "Total chr length", ylab = "Mean exon length", cex = 0.5) + abline(lm(mean ~ sum, data=exon_chr_merge), col="red")
plot(exon_chr_merge$sum, exon_chr_merge$mean, pch=19, xlab = "Total chr length", ylab = "Mean exon length", cex = 0.5) + abline(lm(mean ~ sum, data=exon_chr_merge), col="red") + title(main = "Scatter plot with best-fit line")
plot(exon_chr_merge$sum, exon_chr_merge$mean, pch=19, xlab = "Total chr length", ylab = "Mean exon length", cex = 0.5) + abline(lm(mean ~ sum, data=exon_chr_merge), col="red") + title(main = "Scatter plot with best-fit line", font.main = 5)
plot(exon_chr_merge$sum, exon_chr_merge$mean, pch=19, xlab = "Total chr length", ylab = "Mean exon length", cex = 0.5) + abline(lm(mean ~ sum, data=exon_chr_merge), col="red") + title(main = "Scatter plot with best-fit line", font.main = 4)
plot(exon_chr_merge$sum, exon_chr_merge$mean, pch=19, xlab = "Total chr length", ylab = "Mean exon length", cex = 0.5) + abline(lm(mean ~ sum, data=exon_chr_merge), col="red") + title(main = "Scatter plot with best-fit line")
plot(exon_chr_merge$sum, exon_chr_merge$mean, pch=19, xlab = "Total chr length", ylab = "Mean exon length", xlim = c(0-50000), cex = 0.5) + abline(lm(mean ~ sum, data=exon_chr_merge), col="red") + title(main = "Scatter plot with best-fit line")
plot(exon_chr_merge$sum, exon_chr_merge$mean, pch=19, xlab = "Total chr length", ylab = "Mean exon length", xlim = c(0, 50000), cex = 0.5) + abline(lm(mean ~ sum, data=exon_chr_merge), col="red") + title(main = "Scatter plot with best-fit line")
plot(exon_chr_merge$sum, exon_chr_merge$mean, pch=19, xlab = "Total chr length", ylab = "Mean exon length", xlim = c(0, 100000), cex = 0.5) + abline(lm(mean ~ sum, data=exon_chr_merge), col="red") + title(main = "Scatter plot with best-fit line")
plot(exon_chr_merge$sum, exon_chr_merge$mean, pch=19, xlab = "Total chr length", ylab = "Mean exon length", xlim = c(0, 100000), ylim = c(0, 1000), cex = 0.5) + abline(lm(mean ~ sum, data=exon_chr_merge), col="red") + title(main = "Scatter plot with best-fit line")
plot(exon_chr_merge$sum, exon_chr_merge$mean, pch=19, xlab = "Total chr length", ylab = "Mean exon length", xlim = c(0, 400000), ylim = c(0, 1000), cex = 0.5) + abline(lm(mean ~ sum, data=exon_chr_merge), col="red") + title(main = "Scatter plot with best-fit line")
plot(exon_chr_merge$sum, exon_chr_merge$mean, pch=19, xlab = "Total chr length", ylab = "Mean exon length", xlim = c(0, 400000), ylim = c(0, 1000), cex = 0.5) + abline(lm(mean ~ sum, data=exon_chr_merge), col="red") + title(main = "Scatter plot with axis adjustement")
plot(exon_chr_merge$sum, exon_chr_merge$mean, pch=19, xlab = "Total chr length", ylab = "Mean exon length", cex = 0.5) + abline(lm(mean ~ sum, data=exon_chr_merge), col="red") + title(main = "Scatter plot with best-fit line") + cor(sum, mean)
typeof(exon_chr_merge$sum)
typeof(exon_chr_merge$mean)
plot(exon_chr_merge$sum, exon_chr_merge$mean, pch=19, xlab = "Total chr length", ylab = "Mean exon length", cex = 0.5) + abline(lm(mean ~ sum, data=exon_chr_merge), col="red") + title(main = "Scatter plot with best-fit line") + cor(exon_chr_merge$sum, exon_chr_merge$mean)
cor(exon_chr_merge$sum, exon_chr_merge$mean)
cor(exon_chr_merge$mean, exon_chr_merge$sum)
hist(exon_X_length$length, right = TRUE, main="Chromosome X", xlab="Exon length", breaks = nrow(exon_X_length))
hist(exon_X_length$length, right = TRUE, xlim = c(0, 1000) main="Chromosome X", xlab="Exon length", breaks = nrow(exon_X_length))
hist(exon_X_length$length, right = TRUE, xlim = c(0, 1000), main="Chromosome X", xlab="Exon length", breaks = nrow(exon_X_length))
hist(exon_X_length$length, right = TRUE, xlim = c(0, 400), main="Chromosome X", xlab="Exon length", breaks = nrow(exon_X_length))
hist(exon_X_length$length, right = TRUE, xlim = c(0, 300), main="Chromosome X", xlab="Exon length", breaks = nrow(exon_X_length))
hist(exon_Y_length$length, right = TRUE, xlim = c(0, 1000), main="Chromosome Y", xlab="Exon length", breaks = nrow(exon_Y_length)) #plotting the histograms.
hist(exon_Y_length$length, right = TRUE, xlim = c(0, 400), main="Chromosome Y", xlab="Exon length", breaks = nrow(exon_Y_length)) #plotting the histograms.
hist(exon_X_length$length, right = TRUE, xlim = c(0, 300), main="Chromosome X (modified x-axis)", xlab="Exon length", breaks = nrow(exon_X_length))
hist(exon_Y_length$length, right = TRUE, xlim = c(0, 400), main="Chromosome Y (modified y-axis)", xlab="Exon length", breaks = nrow(exon_Y_length)) #plotting the histograms.
